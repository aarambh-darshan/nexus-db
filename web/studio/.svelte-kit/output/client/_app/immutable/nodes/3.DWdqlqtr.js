import"../chunks/Bzak7iHL.js";import{o as vt}from"../chunks/CHYVOm2z.js";import{p as ct,s as A,a as pt,b as ft,c as i,d,n as l,g as e,u as _,r as o,t as P,e as w,f as L}from"../chunks/-vKrXhex.js";import{f as x,a,t as m,s as $,c as R}from"../chunks/FTzCPRq0.js";import{i as O,c as Q}from"../chunks/D1rrPloc.js";import{B as S,g as ut,r as gt,e as _t,s as mt,i as $t}from"../chunks/DNf00C4f.js";import{C as xt}from"../chunks/DwcntQWW.js";import{C as ht}from"../chunks/Dp98T8lE.js";import{B as j}from"../chunks/CYwCRfUz.js";var bt=x('<p class="text-muted-foreground">Loading...</p>'),yt=x('No migrations. Run <code class="bg-muted px-1 rounded">nexus migrate new init</code>',1),Pt=x('<div class="flex items-center gap-4 px-4 py-3"><div></div> <div class="flex-1"><div class="font-mono text-sm"> </div> <div class="text-xs text-muted-foreground"> </div></div> <!></div>'),wt=x('<div class="divide-y"></div>'),Mt=x('<div class="p-6"><div class="flex items-center justify-between mb-6"><h1 class="text-2xl font-bold">Migrations</h1> <div class="flex gap-2"><!> <!></div></div> <div class="flex gap-4 mb-6"><!> <!></div> <!></div>');function Dt(T,U){ct(U,!0);let p=A(pt([])),F=A(!0),h=A(!1);async function N(){try{w(p,await ut(),!0)}catch(t){console.error("Failed to load:",t)}finally{w(F,!1)}}async function q(t){w(h,!0);try{await gt(t),await N()}catch(r){console.error("Migration failed:",r)}finally{w(h,!1)}}vt(N);const z=_(()=>e(p).filter(t=>t.applied).length),D=_(()=>e(p).filter(t=>!t.applied).length);var M=Mt(),C=i(M),E=d(i(C),2),G=i(E);{let t=_(()=>e(h)||e(z)===0);S(G,{variant:"outline",onclick:()=>q("down"),get disabled(){return e(t)},children:(r,s)=>{l();var f=m("Rollback");a(r,f)},$$slots:{default:!0}})}var V=d(G,2);{let t=_(()=>e(h)||e(D)===0);S(V,{onclick:()=>q("up"),get disabled(){return e(t)},children:(r,s)=>{l();var f=m("Migrate");a(r,f)},$$slots:{default:!0}})}o(E),o(C);var k=d(C,2),H=i(k);j(H,{variant:"secondary",children:(t,r)=>{l();var s=m();P(()=>$(s,`${e(z)??""} applied`)),a(t,s)},$$slots:{default:!0}});var W=d(H,2);j(W,{variant:"outline",children:(t,r)=>{l();var s=m();P(()=>$(s,`${e(D)??""} pending`)),a(t,s)},$$slots:{default:!0}}),o(k);var X=d(k,2);{var Y=t=>{var r=bt();a(t,r)},Z=t=>{var r=R(),s=L(r);Q(s,()=>xt,(f,tt)=>{tt(f,{children:(et,Ct)=>{var I=R(),at=L(I);{var rt=v=>{var c=R(),B=L(c);Q(B,()=>ht,(n,u)=>{u(n,{class:"py-8 text-center text-muted-foreground",children:(b,y)=>{l();var g=yt();l(),a(b,g)},$$slots:{default:!0}})}),a(v,c)},st=v=>{var c=wt();_t(c,21,()=>e(p),$t,(B,n)=>{var u=Pt(),b=i(u),y=d(b,2),g=i(y),ot=i(g,!0);o(g);var J=d(g,2),it=i(J,!0);o(J),o(y);var dt=d(y,2);{let nt=_(()=>e(n).applied?"secondary":"outline");j(dt,{get variant(){return e(nt)},children:(lt,kt)=>{l();var K=m();P(()=>$(K,e(n).applied?"Applied":"Pending")),a(lt,K)},$$slots:{default:!0}})}o(u),P(()=>{mt(b,1,`w-2 h-2 rounded-full ${e(n).applied?"bg-green-500":"bg-muted"}`),$(ot,e(n).id),$(it,e(n).name)}),a(B,u)}),o(c),a(v,c)};O(at,v=>{e(p).length===0?v(rt):v(st,!1)})}a(et,I)},$$slots:{default:!0}})}),a(t,r)};O(X,t=>{e(F)?t(Y):t(Z,!1)})}o(M),a(T,M),ft()}export{Dt as component};
